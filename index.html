<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>India Weather Dashboard â€” Current + Chart</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#1a0f24; --card:#22132d; --muted:#c3b6d4; --accent:#e879f9;
      --glass: rgba(255,255,255,0.05);
    }
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial; margin:0; background:linear-gradient(180deg,#2d0b45 0%, #1a0f24 70%); color:#f0eaf7; min-height:100vh; padding:28px}
    .wrapper{max-width:1100px;margin:0 auto}

    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    header h1{font-size:20px;margin:0}
    header p{margin:0;color:var(--muted);font-size:13px}

    .search{display:flex;gap:12px;margin-bottom:18px}
    .search input{flex:1;padding:12px 14px;border-radius:12px;border:0;background:var(--glass);color:inherit;font-size:15px}
    .search button{padding:10px 14px;border-radius:12px;border:0;background:linear-gradient(90deg,var(--accent),#a855f7);color:#2e063d;font-weight:600;cursor:pointer}

    .grid{display:grid;grid-template-columns:1fr 380px;gap:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03)); padding:18px;border-radius:16px;box-shadow:0 6px 20px rgba(10,6,23,0.6);}

    .current{display:flex;gap:18px;align-items:center}
    .current .meta{flex:1}
    .temp{font-size:64px;font-weight:700;line-height:1;color:#f5d0fe}
    .desc{font-weight:600;color:var(--muted);margin-top:6px}
    .details{display:flex;gap:12px;margin-top:12px}
    .detail{background:rgba(255,255,255,0.06);padding:10px;border-radius:10px;min-width:90px;text-align:center}
    .detail small{display:block;color:var(--muted);font-size:12px}

    .chart-wrap{height:260px}
    .forecast-list{display:flex;gap:10px;overflow:auto;padding-top:12px}
    .f-item{min-width:90px;padding:10px;border-radius:10px;background:rgba(255,255,255,0.06);text-align:center}

    footer{margin-top:18px;color:var(--muted);font-size:13px}

    @media (max-width:920px){
      .grid{grid-template-columns:1fr;}
      .chart-wrap{height:220px}
      .temp{font-size:48px}
    }

    .small-note{color:var(--muted);font-size:13px}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.12);padding:8px 10px;border-radius:10px;color:var(--muted);cursor:pointer}
  </style>
</head>
<body>
  <div class="wrapper">
    <header>
      <div>
        <h1>India Weather Dashboard</h1>
        <p>Current weather + charted short-term forecast (OpenWeatherMap)</p>
      </div>
      <div class="small-note">Tip: click "Use my location" for automatic location data</div>
    </header>

    <div class="search">
      <input id="city-input" placeholder="Enter city (e.g., Mumbai, Delhi, Chennai)" />
      <button id="search-btn">Search</button>
      <button id="loc-btn" class="btn-ghost">Use my location</button>
    </div>

    <div class="grid">
      <div class="card">
        <div class="current">
          <div class="meta">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div id="location" style="font-weight:700;font-size:18px">--</div>
                <div id="time" class="desc">--</div>
              </div>
              <img id="icon" src="" alt="" width="90" height="90" style="filter:drop-shadow(0 6px 20px rgba(0,0,0,0.6));">
            </div>

            <div style="display:flex;align-items:flex-end;gap:18px;margin-top:8px">
              <div>
                <div id="temp" class="temp">--Â°C</div>
                <div id="cond" class="desc">--</div>
              </div>
              <div style="flex:1">
                <div class="details">
                  <div class="detail"><strong id="feels">--Â°C</strong><small>Feels</small></div>
                  <div class="detail"><strong id="hum">--%</strong><small>Humidity</small></div>
                  <div class="detail"><strong id="wind">--</strong><small>Wind</small></div>
                </div>
              </div>
            </div>

            <div style="margin-top:14px;display:flex;gap:8px;flex-wrap:wrap">
              <button id="refresh" class="btn-ghost">Refresh</button>
              <div id="status" class="small-note">Ready</div>
            </div>
          </div>
        </div>

        <hr style="opacity:0.08;margin:18px 0">
        <div>
          <h3 style="margin:0 0 8px 0">Short-term forecast (chart)</h3>
          <div class="chart-wrap card" style="padding:12px">
            <canvas id="tempChart"></canvas>
          </div>

          <div class="forecast-list" id="forecastList" aria-live="polite" style="margin-top:12px"></div>
        </div>
      </div>

      <div class="card">
        <h3 style="margin-top:0">Details & Units</h3>
        <p class="small-note">This demo uses OpenWeatherMap's <code>weather</code> (current) and <code>forecast</code> (3-hourly) APIs. Replace the API key in the script before using.</p>
        <ul style="color:var(--muted);font-size:14px">
          <li>Temperatures: Celsius</li>
          <li>Wind speed: m/s</li>
          <li>Forecast plotted for next 8 entries (~24 hours)</li>
        </ul>

        <hr style="opacity:0.08">
        <h4 style="margin-bottom:8px">How to use</h4>
        <ol style="color:var(--muted);font-size:14px">
          <li>Get free API key at <strong>openweathermap.org</strong>.</li>
          <li>Replace the <code>apiKey</code> string.</li>
          <li>Open this file in browser or serve with local server for geolocation.</li>
        </ol>
      </div>
    </div>

    <footer>
      Built with ðŸŒ¸ â€” replace <code>apiKey</code> then click Search or Use my location.
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const apiKey = '361711303765e72ebde4a980513a814a';
    const searchBtn = document.getElementById('search-btn');
    const locBtn = document.getElementById('loc-btn');
    const refreshBtn = document.getElementById('refresh');
    const cityInput = document.getElementById('city-input');
    const status = document.getElementById('status');

    const el = id => document.getElementById(id);
    let chart;

    async function fetchWeatherByCity(city){
      if(!apiKey || apiKey.includes('REPLACE')){ alert('Please replace the apiKey variable'); return; }
      try{
        setStatus('Fetching current weather...');
        const currRes = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)}&appid=${apiKey}&units=metric`);
        if(!currRes.ok) throw new Error('City not found');
        const curr = await currRes.json();
        const {coord} = curr;
        await updateUIWithCurrent(curr);
        await fetchForecast(coord.lat, coord.lon);
        setStatus('Updated');
      }catch(err){
        console.error(err);
        setStatus('Error: ' + err.message);
      }
    }

    async function fetchWeatherByCoords(lat, lon){
      if(!apiKey || apiKey.includes('REPLACE')){ alert('Please replace the apiKey variable'); return; }
      try{
        setStatus('Fetching current weather...');
        const currRes = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`);
        const curr = await currRes.json();
        await updateUIWithCurrent(curr);
        await fetchForecast(lat, lon);
        setStatus('Updated');
      }catch(err){
        console.error(err);
        setStatus('Error: ' + err.message);
      }
    }

    async function fetchForecast(lat, lon){
      setStatus('Fetching forecast...');
      const res = await fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`);
      const data = await res.json();
      if(!data || !data.list) { setStatus('No forecast'); return; }
      const slice = data.list.slice(0, 8);
      renderForecastList(slice);
      renderChart(slice);
    }

    function updateUIWithCurrent(curr){
      el('location').textContent = `${curr.name}, ${curr.sys?.country || ''}`.trim();
      el('time').textContent = new Date(curr.dt * 1000).toLocaleString();
      el('temp').textContent = Math.round(curr.main.temp) + 'Â°C';
      el('cond').textContent = curr.weather[0].main + ' â€” ' + curr.weather[0].description;
      el('feels').textContent = Math.round(curr.main.feels_like) + 'Â°C';
      el('hum').textContent = curr.main.humidity + '%';
      el('wind').textContent = (curr.wind.speed || 0) + ' m/s';
      const iconCode = curr.weather[0].icon;
      el('icon').src = `https://openweathermap.org/img/wn/${iconCode}@4x.png`;
    }

    function renderForecastList(slice){
      const container = el('forecastList');
      container.innerHTML = '';
      slice.forEach(item =>{
        const dt = new Date(item.dt * 1000);
        const time = dt.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
        const temp = Math.round(item.main.temp) + 'Â°C';
        const icon = item.weather[0].icon;
        const div = document.createElement('div');
        div.className = 'f-item';
        div.innerHTML = `<div style="font-weight:600">${time}</div><img src=\"https://openweathermap.org/img/wn/${icon}@2x.png\" width=56 height=56 alt=\"\" /><div style=\"margin-top:6px\">${temp}</div><div style=\"color:var(--muted);font-size:12px\">${item.weather[0].main}</div>`;
        container.appendChild(div);
      });
    }

    function renderChart(slice){
      const labels = slice.map(s=> new Date(s.dt*1000).toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'}));
      const temps = slice.map(s=> Math.round(s.main.temp));
      const ctx = document.getElementById('tempChart').getContext('2d');
      if(chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: { labels, datasets:[{label:'Temperature (Â°C)', data:temps, tension:0.3, fill:true, backgroundColor:'rgba(232,121,249,0.2)', borderColor:'#e879f9', borderWidth:2}]},
        options:{ responsive:true, scales:{y:{beginAtZero:false}}, plugins:{legend:{display:false}} }
      });
    }

    function setStatus(txt){ status.textContent = txt; }

    searchBtn.addEventListener('click', ()=>{
      const city = cityInput.value.trim();
      if(!city) { alert('Type a city name'); return; }
      fetchWeatherByCity(city);
    });

    refreshBtn.addEventListener('click', ()=>{
      const city = cityInput.value.trim();
      if(city) fetchWeatherByCity(city);
    });

    locBtn.addEventListener('click', ()=>{
      if(!navigator.geolocation){ alert('Geolocation not supported'); return; }
      setStatus('Locating...');
      navigator.geolocation.getCurrentPosition(pos =>{
        const {latitude, longitude} = pos.coords;
        fetchWeatherByCoords(latitude, longitude);
      }, ()=>{ setStatus('Geolocation denied'); });
    });

    cityInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') searchBtn.click(); });
    (function init(){ cityInput.value = 'Bengaluru'; })();
  </script>
</body>
</html>
